<!DOCTYPE html>
<html lang="en">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta charset="UTF-8">
    <title>StjÃ¤rnakademien - Manage Users</title>
    <link rel="stylesheet" href="styles.css">
    <script>
        function setViewportHeight() {
            let vh = window.innerHeight * 0.01;
            document.documentElement.style.setProperty('--vh', `${vh}px`);
        }
        window.addEventListener('resize', setViewportHeight);
        window.addEventListener('orientationchange', setViewportHeight);
        setViewportHeight();
    </script>
</head>
<body>
    <nav class="hamburger-nav">
        <div class="hamburger" aria-expanded="false" aria-controls="main-menu">â˜°</div>
        <div class="menu" id="main-menu">
            <span class="close-btn" aria-label="Close menu">âœ–</span>
            <a href="index.html" class="menu-link">Progress Overview</a>
            <a href="chapter1.html" class="menu-link">Chapter 1</a>
            <a href="chapter2.html" class="menu-link">Chapter 2</a>
            <a href="chapter3.html" class="menu-link">Chapter 3</a>
            <a href="chapter4.html" class="menu-link">Chapter 4</a>
            <a href="chapter5.html" class="menu-link">Chapter 5</a>
            <a href="chapter6.html" class="menu-link">Chapter 6</a>
            <a href="chapter7.html" class="menu-link">Chapter 7</a>
            <a href="manage-users.html" class="menu-link">Manage Users</a>
            <div class="language-switcher">
                <span class="flag" onclick="switchLanguage('en')">ðŸ‡¬ðŸ‡§</span>
                <span class="flag" onclick="switchLanguage('sv')">ðŸ‡¸ðŸ‡ª</span>
            </div>
        </div>
    </nav>
    <div class="user-management">
        <h1>Manage Users</h1>
        <input type="text" id="newUserInput" placeholder="Enter new user name">
        <button onclick="addUser()">Add User</button>
        <select id="userDropdown" onchange="switchUser(this.value)">
            <option value="">Select a user</option>
        </select>
    </div>
    <script src="script.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const hamburger = document.querySelector('.hamburger');
            const menu = document.querySelector('.menu');
            const closeBtn = document.querySelector('.close-btn');

            menu.style.left = '-250px';

            hamburger.addEventListener('click', () => {
                const isExpanded = hamburger.getAttribute('aria-expanded') === 'true';
                hamburger.setAttribute('aria-expanded', !isExpanded);
                if (!isExpanded) {
                    menu.classList.add('active');
                    menu.animate([{ left: '-250px' }, { left: '0' }], { duration: 300, easing: 'ease-in-out', fill: 'forwards' });
                } else {
                    menu.animate([{ left: '0' }, { left: '-250px' }], { duration: 300, easing: 'ease-in-out', fill: 'forwards' }).onfinish = () => {
                        menu.classList.remove('active');
                    };
                }
            });

            closeBtn.addEventListener('click', () => {
                hamburger.setAttribute('aria-expanded', 'false');
                menu.animate([{ left: '0' }, { left: '-250px' }], { duration: 300, easing: 'ease-in-out', fill: 'forwards' }).onfinish = () => {
                    menu.classList.remove('active');
                };
            });

            document.querySelectorAll('.menu-link').forEach(link => {
                link.addEventListener('click', () => {
                    hamburger.setAttribute('aria-expanded', 'false');
                    menu.animate([{ left: '0' }, { left: '-250px' }], { duration: 300, easing: 'ease-in-out', fill: 'forwards' }).onfinish = () => {
                        menu.classList.remove('active');
                    };
                });
            });

            document.addEventListener('click', (e) => {
                if (!hamburger.contains(e.target) && !menu.contains(e.target)) {
                    hamburger.setAttribute('aria-expanded', 'false');
                    menu.animate([{ left: '0' }, { left: '-250px' }], { duration: 300, easing: 'ease-in-out', fill: 'forwards' }).onfinish = () => {
                        menu.classList.remove('active');
                    };
                }
            });

            // Initialize user management
            loadUsers();
        });

        function addUser() {
            const newUserInput = document.getElementById('newUserInput');
            const userName = newUserInput.value.trim();
            if (userName && !getUsers().includes(userName)) {
                localStorage.setItem('users', JSON.stringify([...getUsers(), userName]));
                newUserInput.value = '';
                loadUsers();
            }
        }

        function getUsers() {
            return JSON.parse(localStorage.getItem('users') || '[]');
        }

        function loadUsers() {
            const userDropdown = document.getElementById('userDropdown');
            const users = getUsers();
            userDropdown.innerHTML = '<option value="">Select a user</option>';
            users.forEach(user => {
                const option = document.createElement('option');
                option.value = user;
                option.textContent = user;
                userDropdown.appendChild(option);
            });
            if (!users.includes(currentUser)) {
                currentUser = users[0] || localStorage.getItem('userName') || 'default';
                localStorage.setItem('currentUser', currentUser);
            }
            userDropdown.value = currentUser;
            updateStarStates(); // Refresh progress for the current user
        }

        function switchUser(userName) {
            if (userName) {
                currentUser = userName;
                localStorage.setItem('currentUser', currentUser);
                console.log(`Switched to user: ${currentUser}`);
                // Redirect to index.html to refresh progress display
                window.location.href = 'index.html';
            }
        }
    </script>
</body>
</html>